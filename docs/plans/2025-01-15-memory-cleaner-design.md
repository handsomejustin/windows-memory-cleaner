# Windows å†…å­˜æ¸…ç†å·¥å…·è®¾è®¡æ–‡æ¡£

## æ¦‚è¿°

å¼€å‘ä¸€ä¸ª Windows æ‰˜ç›˜å¸¸é©»å·¥å…·ï¼Œç”¨äºæ¸…ç†ç³»ç»Ÿå†…å­˜ç¼“å­˜ï¼Œè§£å†³å¼€å‘ç¯å¢ƒé•¿æ—¶é—´è¿è¡Œåå†…å­˜å ç”¨è¿‡é«˜å¯¼è‡´çš„å¡é¡¿é—®é¢˜ã€‚

## éœ€æ±‚

- **è§¦å‘æ–¹å¼**: æ‰˜ç›˜å¸¸é©»å·¥å…·ï¼Œæ‰‹åŠ¨è§¦å‘æ¸…ç†
- **æ¸…ç†ç­–ç•¥**: ä»…æ¸…ç†ç³»ç»Ÿç¼“å­˜ï¼Œä¸å½±å“è¿è¡Œä¸­çš„è¿›ç¨‹
- **æ˜¾ç¤ºä¿¡æ¯**: åŸºç¡€ä¿¡æ¯ + æ¸…ç†æ—¥å¿— + é˜ˆå€¼æé†’

## æ¶æ„è®¾è®¡

### ä¸‰å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      æ‰˜ç›˜ç•Œé¢å±‚ (Presentation)      â”‚
â”‚  - pystray æ‰˜ç›˜å›¾æ ‡               â”‚
â”‚  - tkinter çŠ¶æ€çª—å£               â”‚
â”‚  - å³é”®èœå•äº¤äº’                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ä¸šåŠ¡é€»è¾‘å±‚ (Business)         â”‚
â”‚  - MemoryMonitor å†…å­˜ç›‘æ§         â”‚
â”‚  - MemoryCleaner æ¸…ç†æ‰§è¡Œ         â”‚
â”‚  - ConfigManager é…ç½®ç®¡ç†         â”‚
â”‚  - LogManager æ—¥å¿—è®°å½•            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      æ•°æ®è®¿é—®å±‚ (Data)             â”‚
â”‚  - psutil ç³»ç»Ÿä¿¡æ¯               â”‚
â”‚  - pywin32 Windows API          â”‚
â”‚  - JSON æ–‡ä»¶å­˜å‚¨                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ ¸å¿ƒæ¨¡å—

### MemoryMonitor

```python
class MemoryMonitor:
    def get_memory_info() -> dict:
        """è¿”å›ç³»ç»Ÿå†…å­˜ä¿¡æ¯"""
        return {
            'total': æ€»å†…å­˜(GB),
            'used': å·²ç”¨å†…å­˜(GB),
            'percent': ä½¿ç”¨ç‡(%),
            'available': å¯ç”¨å†…å­˜(GB)
        }

    def start_monitoring():
        """å¯åŠ¨åå°ç›‘æ§çº¿ç¨‹"""

    def set_threshold(percent: int):
        """è®¾ç½®è­¦å‘Šé˜ˆå€¼"""
```

### MemoryCleaner

```python
class MemoryCleaner:
    def clean_system_cache():
        """è°ƒç”¨ Windows API æ¸…ç†ç³»ç»Ÿç¼“å­˜"""
        # kernel32.SetProcessWorkingSetSize(-1, -1, -1)

    def get_cleanable_size() -> int:
        """ä¼°ç®—å¯æ¸…ç†çš„ç¼“å­˜å¤§å°"""

    def clean() -> dict:
        """æ‰§è¡Œæ¸…ç†å¹¶è¿”å›æ•ˆæœ"""
        # è¿”å›: {before, after, freed}
```

### æ‰˜ç›˜ç•Œé¢

**å›¾æ ‡çŠ¶æ€**
- ç»¿è‰²: å†…å­˜ < 70%
- é»„è‰²: 70-85%
- çº¢è‰²: > 85%

**æ‚¬æµ®æç¤º**: `å†…å­˜: 22.5/64GB (35%) - å¯æ¸…ç†: ~1.2GB`

**å³é”®èœå•**
```
ğŸ“Š æ˜¾ç¤ºå†…å­˜çŠ¶æ€...
ğŸ§¹ ç«‹å³æ¸…ç†å†…å­˜
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âš™ï¸ è®¾ç½®...
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âŒ é€€å‡º
```

**çŠ¶æ€çª—å£** (tkinter)
- å†…å­˜ä½¿ç”¨è¿›åº¦æ¡
- æœ€è¿‘ 10 æ¡æ¸…ç†è®°å½•
- ç«‹å³æ¸…ç†æŒ‰é’®

### é…ç½®é¡¹

```json
{
  "warning_threshold": 85,
  "auto_clean": false,
  "auto_clean_threshold": 80,
  "refresh_interval": 5
}
```

## é¡¹ç›®ç»“æ„

```
clear_mem/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ memory_monitor.py
â”‚   â”œâ”€â”€ memory_cleaner.py
â”‚   â”œâ”€â”€ tray_app.py
â”‚   â””â”€â”€ config.py
â”œâ”€â”€ config.json
â”œâ”€â”€ logs/
â”œâ”€â”€ icons/
â”œâ”€â”€ main.py
â”œâ”€â”€ requirements.txt
â””â”€â”€ docs/
    â””â”€â”€ plans/
        â””â”€â”€ 2025-01-15-memory-cleaner-design.md
```

## ä¾èµ–

```
pystray       # æ‰˜ç›˜å›¾æ ‡
psutil        # ç³»ç»Ÿä¿¡æ¯
pywin32       # Windows API
```

## é”™è¯¯å¤„ç†

- ç®¡ç†å‘˜æƒé™æ£€æµ‹
- API è°ƒç”¨å¼‚å¸¸æ•è·
- ç›‘æ§çº¿ç¨‹ç‹¬ç«‹è¿è¡Œ
- é…ç½®æ–‡ä»¶æŸåé‡å»º

## æ‰“åŒ…

ä½¿ç”¨ PyInstaller æ‰“åŒ…ä¸ºå•ä¸ª exe:
```bash
pyinstaller --onefile --windowed --icon=icons/app.ico main.py
```

## å®‰å…¨æ€§

- ä»…è°ƒç”¨ç³»ç»Ÿçº§æ¸…ç† API
- ä¸ä¿®æ”¹ä»»ä½•è¿›ç¨‹
- æ— ç½‘ç»œè®¿é—®
- é…ç½®æœ¬åœ°å­˜å‚¨
